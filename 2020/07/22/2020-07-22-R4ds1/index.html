<!-- build time:Fri Jul 07 2023 15:48:12 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="小钊の笔记" href="https://www.zhouxiaozhao.cn/rss.xml"><link rel="alternate" type="application/atom+xml" title="小钊の笔记" href="https://www.zhouxiaozhao.cn/atom.xml"><link rel="alternate" type="application/json" title="小钊の笔记" href="https://www.zhouxiaozhao.cn/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="R_study,R_For_Data_science"><link rel="canonical" href="https://www.zhouxiaozhao.cn/2020/07/22/2020-07-22-R4ds1/"><title>R 数据科学笔记：1 - R | Zhou Xiaozhao = 小钊の笔记 = 前天是小兔子，昨天是小鹿，今天是你</title><meta name="generator" content="Hexo 5.4.1"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">R 数据科学笔记：1</h1><div class="meta"><span class="item" title="创建时间：2020-07-22 18:38:45"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2020-07-22T18:38:45+08:00">2020-07-22</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>14k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>13 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Zhou Xiaozhao</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://img1.imgtp.com/2023/02/01/RJVmoMVH.jpg"></li><li class="item" data-background-image="https://img1.imgtp.com/2023/02/01/piDPxYxl.jpg"></li><li class="item" data-background-image="https://img1.imgtp.com/2023/02/01/akEUQCIt.jpg"></li><li class="item" data-background-image="https://img1.imgtp.com/2023/02/01/MRMqrWXd.jpg"></li><li class="item" data-background-image="https://img1.imgtp.com/2023/02/01/GOGkua2f.jpg"></li><li class="item" data-background-image="https://img1.imgtp.com/2023/02/01/u2N1wYKS.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/R/" itemprop="item" rel="index" title="分类于 R"><span itemprop="name">R</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.zhouxiaozhao.cn/2020/07/22/2020-07-22-R4ds1/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="amane"><meta itemprop="description" content="前天是小兔子，昨天是小鹿，今天是你, 生物学在读博士"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="小钊の笔记"></span><div class="body md" itemprop="articleBody"><p>最近把之前的《R 数据科学》的笔记整理一下，大概每篇文章整理 2-3 章，这本书有中英文两版，不知道为什么中文版比英文版少了一章，而且一些关键内容也有所删减，所以大家学习这本书的时候以英文版为准。<br>电子书下载地址：<span class="exturl" data-url="aHR0cDovL2ZpbGUuYWxsaXRlYm9va3MuY29tLzIwMTYxMjMwL1IlMjBmb3IlMjBEYXRhJTIwU2NpZW5jZS0lMjBJbXBvcnQsJTIwVGlkeSwlMjBUcmFuc2Zvcm0sJTIwVmlzdWFsaXplLCUyMGFuZCUyME1vZGVsJTIwRGF0YS5wZGY=">《R4ds》</span><br>源代码地址：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hhZGxleS9yNGRz">https://github.com/hadley/r4ds</span></p><h1 id="作者简介"><a class="anchor" href="#作者简介">#</a> 作者简介：</h1><p>哈德利・威克姆（Hadley Wickham）</p><p>RStudio 首席科学家，统计学家，斯坦福大学、奥克兰大学、莱斯大学兼职统计学教授。已被下载数百万次的 ggplot2 等多款知名 R 包的开发者，一直致力于让普罗大众更容易上手数据分析，被 R 社区誉为 “改变了 R 的人”。另著有《R 包开发》等书。</p><p>加勒特・格罗勒芒德（Garrett Grolemund）</p><p>RStudio 数据科学家，知名 R 培训师，曾受邀在 Google、eBay 等诸多公司讲授 R 语言和数据科学，在 DataCamp 开授的 R 相关课程备受 R 开发者喜爱。另著有《R 语言入门与实践》。</p><h1 id="第一章使用ggplot2进行数据可视化"><a class="anchor" href="#第一章使用ggplot2进行数据可视化">#</a> 第一章：使用 ggplot2 进行数据可视化</h1><h2 id="11-简介"><a class="anchor" href="#11-简介">#</a> 1.1 简介</h2><p><strong>准备工作</strong></p><p>本章重点讨论 tidyverse 的一个核心 R 包 ——ggplot2。为了访问本章用到的数据集、帮助页面和函数，需要先运行以下代码来加载 tidyverse</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>install.packages(&quot;tidyverse&quot;)</pre></td></tr><tr><td data-num="2"></td><td><pre>library(tidyverse)</pre></td></tr></table></figure><h2 id="12-第一步"><a class="anchor" href="#12-第一步">#</a> 1.2 第一步</h2><p>我们使用第一张图来回答问题：大引擎汽车比小引擎汽车更耗油吗？你可能已经有了答案，但应该努力让答案更精确一些。引擎大小与燃油效率之间是什么关系？是正相关，还是负相关？是线性关系，还是非线性关系？</p><h3 id="121-mpg数据框"><a class="anchor" href="#121-mpg数据框">#</a> 1.2.1 mpg 数据框</h3><p>你可以使用 ggplot2 包中的 mpg 数据框（即 ggplot2::mpg）来检验自己的答案。数据框是变量（列）和观测（行）的矩形集合。mpg 包含了由美国环境保护协会收集的 38 种车型的观测数据。</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>&gt; mpg</pre></td></tr><tr><td data-num="2"></td><td><pre># A tibble: 234 x 11</pre></td></tr><tr><td data-num="3"></td><td><pre>   manufacturer model displ  year   cyl trans drv     cty   hwy fl   </pre></td></tr><tr><td data-num="4"></td><td><pre>   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;</pre></td></tr><tr><td data-num="5"></td><td><pre> 1 audi         a4      1.8  1999     4 auto~ f        18    29 p    </pre></td></tr><tr><td data-num="6"></td><td><pre> 2 audi         a4      1.8  1999     4 manu~ f        21    29 p    </pre></td></tr><tr><td data-num="7"></td><td><pre> 3 audi         a4      2    2008     4 manu~ f        20    31 p    </pre></td></tr><tr><td data-num="8"></td><td><pre> 4 audi         a4      2    2008     4 auto~ f        21    30 p    </pre></td></tr><tr><td data-num="9"></td><td><pre> 5 audi         a4      2.8  1999     6 auto~ f        16    26 p    </pre></td></tr><tr><td data-num="10"></td><td><pre> 6 audi         a4      2.8  1999     6 manu~ f        18    26 p    </pre></td></tr><tr><td data-num="11"></td><td><pre> 7 audi         a4      3.1  2008     6 auto~ f        18    27 p    </pre></td></tr><tr><td data-num="12"></td><td><pre> 8 audi         a4 q~   1.8  1999     4 manu~ 4        18    26 p    </pre></td></tr><tr><td data-num="13"></td><td><pre> 9 audi         a4 q~   1.8  1999     4 auto~ 4        16    25 p    </pre></td></tr><tr><td data-num="14"></td><td><pre>10 audi         a4 q~   2    2008     4 manu~ 4        20    28 p    </pre></td></tr><tr><td data-num="15"></td><td><pre># ... with 224 more rows, and 1 more variable: class &lt;chr&gt;</pre></td></tr></table></figure><p>mpg 中包括如下变量。<br>・displ：引擎大小，单位为升。<br>・hwy：汽车在高速公路上行驶时的燃油效率，单位为英里 / 加仑（mpg）。与燃油效率高的汽车相比，燃油效率低的汽车在行驶相同距离时要消耗更多燃油。要想了解更多关于 mpg 的信息，可以使用？mpg 命令打开其帮助页面。</p><h3 id="122-创建ggplot图形"><a class="anchor" href="#122-创建ggplot图形">#</a> 1.2.2　创建 ggplot 图形</h3><p>为了绘制 mpg 的图形，运行以下代码将 displ 放在 x 轴，hwy 放在 y 轴：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_point(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy))</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727152251428.png" alt="image-20200727152251428"><br>上图显示出引擎大小（displ）和燃油效率（hwy）之间是负相关关系。换句话说，大引擎汽车更耗油。<br>在 ggplot2 中，你可以使用 ggplot () 函数开始绘图。ggplot () 创建了一个坐标系，你可以在它上面添加图层。ggplot () 的第一个参数是要在图中使用的数据集。ggplot (data = mpg) 会创建一张空白图，因为这张图没什么意思，所以就不在这里展示了。</p><p>函数 geom_point () 向图中添加一个点层，这样就可以创建一张散点图。ggplot2 中包含了多种几何对象函数，每种函数都可以向图中添加不同类型的图层。</p><p>ggplot2 中的每个几何对象函数都有一个 mapping 参数。这个参数定义了如何将数据集中的变量映射为图形属性。mapping 参数总是与 aes () 函数成对出现，aes () 函数的 x 参数和 y 参数分别指定了映射到 x 轴的变量与映射到 y 轴的变量。ggplot2 在 data 参数中寻找映射变量，本例中就是 mpg。</p><h3 id="123-绘图模板"><a class="anchor" href="#123-绘图模板">#</a> 1.2.3　绘图模板</h3><p>将上面的代码转换为一个可重用的 ggplot2 绘图模板。要想生成一张图，将以下代码中的尖括号部分替换为数据集、几何对象函数或映射集合即可：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; &lt;DATA&gt;) +</pre></td></tr><tr><td data-num="2"></td><td><pre>&lt;GEOM_FUNCTION&gt;(mapping &#x3D; aes(&lt;MAPPINGS&gt;))</pre></td></tr></table></figure><h3 id="124-练习"><a class="anchor" href="#124-练习">#</a> 1.2.4　练习</h3><p>(1) 运行 ggplot (data = mpg)，你会看到什么？</p><p>一片空白</p><p>(2) 数据集 mpg 中有多少行？多少列？</p><p>234 行 11 列</p><p>(3) 变量 drv 的意义是什么？使用？mpg 命令阅读帮助文件以找出答案。</p><p>传动系的类型，其中 f = 前轮驱动，r = 后轮驱动，4 = 4wd</p><p>(4) 使用 hwy 和 cyl 绘制一张散点图。</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_point(mapping &#x3D; aes(x &#x3D; cyl, y &#x3D; hwy))</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727154817123.png" alt="image-20200727154817123"></p><p>(5) 如果使用 class 和 drv 绘制散点图，会发生什么情况？为什么这张图没什么用处？</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_point(mapping &#x3D; aes(x &#x3D; class, y &#x3D;drv))</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727155016347.png" alt="image-20200727155016347"></p><p>车的类型与驱动类型之间没有对应关系，或者说两者无法发生关系。</p><h2 id="13-图形属性映射"><a class="anchor" href="#13-图形属性映射">#</a> 1.3　图形属性映射</h2><p>The greatest value of a picture is when it forces us to notice what we never expected to see. —John Tukey</p><p>下图中有一组点（显示为红色）似乎位于线性趋势之外。这些汽车比预期具有更高的里程数。</p><p><img data-src="/img/posts/7.22/image-20200727155501240.png" alt="image-20200727155501240"></p><p>假设这些汽车是混合动力车。检验这种假设的一个方法是查看每辆汽车的 class 值。mpg 数据集中的 class 变量对汽车进行了分类，比如小型、中型和 SUV。如果那些离群点是混合动力车，那么它们应该分类为小型车，也可能是微型车（注意，这份数据是在混合动力车和 SUV 流行前收集的）。</p><p>可以向二维散点图中添加第三个变量，比如 class，方式是将它映射为图形属性。图形属性是图中对象的可视化属性，其中包括数据点的大小、形状和颜色。通过改变图形属性的值，可以用不同的方式来显示数据点（如下图所示）。因为已经使用 “value” 这个词来表示数据的值，所以下面使用 “level”（水平）这个词来表示图形属性的值。我们来改变一个点的大小、形状和颜色来反映不同属性。</p><p>通过将图中的图形属性映射为数据集中的变量，可以传达出数据的相关信息。例如，可以将点的颜色映射为变量 class，从而揭示每辆汽车的类型：</p><p><img data-src="/img/posts/7.22/image-20200727155634566.png" alt="image-20200727155634566"></p><p>要想将图形属性映射为变量，需要在函数 aes () 中将图形属性名称和变量名称关联起来。ggplot2 会自动为每个变量值分配唯一的图形属性水平（本例中是唯一的颜色），这个过程称为标度变换。ggplot2 还会添加一个图例，以表示图形属性水平和变量值之间的对应关系。</p><p>也可以用同样的方式将其映射为点的大小。在下面的示例中，每个点的实际大小表示其所属的类别。这里我们收到一条警告信息，因为将无序变量（class）映射为有序图形属性（size）可不是好主意。</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre> geom_point(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy, size &#x3D; class))</pre></td></tr><tr><td data-num="3"></td><td><pre>Warning message:</pre></td></tr><tr><td data-num="4"></td><td><pre>Using size for a discrete variable is not advised.</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727160611084.png" alt="image-20200727160611084"></p><p>或者我们也可以将 class 映射为控制数据点透明度的 alpha 图形属性，还可以将其映射为点的形状。</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre># 上图</pre></td></tr><tr><td data-num="2"></td><td><pre>ggplot (data &#x3D; mpg) +</pre></td></tr><tr><td data-num="3"></td><td><pre>  geom_point (mapping &#x3D; aes (x &#x3D; displ, y &#x3D; hwy, alpha &#x3D; class))</pre></td></tr><tr><td data-num="4"></td><td><pre># 下图</pre></td></tr><tr><td data-num="5"></td><td><pre>ggplot (data &#x3D; mpg) +</pre></td></tr><tr><td data-num="6"></td><td><pre>  geom_point (mapping &#x3D; aes (x &#x3D; displ, y &#x3D; hwy, shape &#x3D; class))</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727160743051.png" alt="image-20200727160743051"></p><p><img data-src="/img/posts/7.22/image-20200727160807617.png" alt="image-20200727160807617"></p><p>SUV 怎么了？ ggplot2 只能同时使用 6 种形状。默认情况下，当使用这种图形属性时，多出的变量值将不会出现在图中。</p><p>一旦映射了图形属性，ggplot2 会处理好其余的事情。它会为图形属性选择一个合适的标度，并创建图例来表示图形属性水平和变量值之间的映射关系。ggplot2 不会为 x 和 y 这两个图形属性创建图例，而会创建带有刻度标记和标签的坐标轴。坐标轴就相当于图例，可以体现出位置和变量值之间的映射关系。</p><p>还可以手动为几何对象设置图形属性。例如，我们可以让图中的所有点都为蓝色：</p><pre><code>ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy), color = &quot;blue&quot;)
</code></pre><p><img data-src="/img/posts/7.22/image-20200727161242744.png" alt="image-20200727161242744"></p><p>此时颜色不会传达关于变量的信息，只是改变图的外观。要想手动设置图形属性，需要按名称进行设置，将其作为几何对象函数的一个参数。这也就是说，需要在函数 aes () 的外部进行设置。此外，还需要为这个图形属性选择一个有意义的值。<br>・颜色名称是一个字符串。<br>・点的大小用毫米表示。<br>・点的形状是一个数值，如图 1-1 所示。有些形状相同，比如 0、15 和 22 都是正方形。<br>形状之间的区别在于 color 和 fill 这两个图形属性。空心形状（0~14）的边界颜色由 color 决定；实心形状（15~20）的填充颜色由 color 决定；填充形状（21~24）的边界颜色由 color 决定，填充颜色由 fill 决定。</p><p><img data-src="/img/posts/7.22/image-20200727161449823.png" alt="image-20200727161449823"></p><p>&lt;center&gt;<br>用数值进行标识的 R 的 25 种内置形状<br>&lt;/center&gt;</p><h3 id="练习"><a class="anchor" href="#练习">#</a> 练习</h3><p>(1) 以下这段代码有什么错误？为什么点不是蓝色的？</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_point(</pre></td></tr><tr><td data-num="3"></td><td><pre>mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy, color &#x3D; &quot;blue&quot;))</pre></td></tr></table></figure><p>color 在 mapping 的括号里面，成为了图形属性映射</p><p>(2) mpg 中的哪些变量是分类变量？哪些变量是连续变量？（提示：输入？mpg 来阅读这个数据集的文档。）当调用 mpg 时，如何才能看到这些信息？</p><p>在每一列的下方有 &lt;chr&gt; 和 &lt; int &gt; 两个属性，其中 &lt; chr &gt; 是分类变量，&lt;int &gt; 是连续变量</p><p>(3) 将一个连续变量映射为 color、size 和 shape。对分类变量和连续变量来说，这些图形属性的表现有什么不同？</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_point(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy, color &#x3D; hwy))</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727162425602.png" alt="image-20200727162425602"></p><p>颜色是一个渐变色，大小也是渐变，形状会报错</p><p>(4) 如果将同一个变量映射为多个图形属性，会发生什么情况？</p><p>两种属性会结合，例如颜色和大小</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_point(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy, size &#x3D; class, color&#x3D;class))</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727162643049.png" alt="image-20200727162643049"></p><p>(5) stroke 这个图形属性的作用是什么？它适用于哪些形状？（提示：使用？geom_point 命令。）</p><p>改变形状的边框的大小</p><p>(6) 如果将图形属性映射为非变量名对象，比如 aes (color = displ &lt; 5)，会发生什么情况？</p><p>Error: geom_point requires the following missing aesthetics: x and y</p><h2 id="14-常见问题"><a class="anchor" href="#14-常见问题">#</a> 1.4 常见问题</h2><p>当开始运行 R 代码时，你很可能会遇到问题。不用担心，每个人都会遇到问题。首先，将你需要运行的代码与书中的代码进行仔细对比。R 极其挑剔，即使一个字母放错了位置，也可能会造成问题。确保每个 (都有一个) 与之匹配，并且每个 &quot;后面都跟着另一个&quot;。有时运行了代码却什么也没有发生。检查一下控制台左侧：如果有一个 + 号，那么说明 R 认为你没有输入完整的表达式，正在等待你完成输入。这种情况下，按 Esc 键中止当前执行的命令就可以重新开始。</p><p>创建 ggplot2 图形时的一个常见问题是将 + 号放错了位置：+ 必须放在一行代码的末尾，而不是开头。</p><h2 id="15-分面"><a class="anchor" href="#15-分面">#</a> 1.5 分面</h2><p>添加额外变量的一种方法是使用图形属性。另一种方法是将图分割成多个分面，即可以显示数据子集的子图。这种方法特别适合添加分类变量。</p><p><img data-src="/img/posts/7.22/image-20200727164020241.png" alt="image-20200727164020241"></p><p>要想通过单个变量对图进行分面，可以使用函数 facet_wrap ()。其第一个参数是一个公式，创建公式的方式是在～符号后面加一个变量名（这里所说的 “公式” 是 R 中的一种数据结构，不是数学意义上的公式）。传递给 facet_wrap () 的变量应该是离散型的。</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_point(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy),stroke&#x3D;1.5) +</pre></td></tr><tr><td data-num="3"></td><td><pre>  facet_wrap(~ class, nrow &#x3D; 2)</pre></td></tr></table></figure><p>要想通过两个变量对图进行分面，需要在绘图命令中加入函数 facet_grid ()。这个函数的第一个参数也是一个公式，但该公式包含由～隔开的两个变量名。</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_point(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="3"></td><td><pre>  facet_grid(drv ~ cyl)</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727164644585.png" alt="image-20200727164644585"></p><p>如果不想在行或列的维度进行分面，你可以使用。来代替变量名，例如 + facet_grid (. ~cyl)。</p><p><img data-src="/img/posts/7.22/image-20200727164809074.png" alt="image-20200727164809074"></p><h3 id="练习-2"><a class="anchor" href="#练习-2">#</a> 练习</h3><p>(1) 如果使用连续变量进行分面，会发生什么情况？</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_point(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="3"></td><td><pre>  facet_grid(~ cty)</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727164920549.png" alt="image-20200727164920549"></p><p>(2) 在使用 facet_grid (drv ~ cyl) 生成的图中，空白单元的意义是什么？它们和以下代码生成的图有什么关系？</p><p>虽然空白单元没有数据，但也代表了一种组合</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_point(mapping &#x3D; aes(x &#x3D; drv, y &#x3D; cyl))</pre></td></tr></table></figure><p>这张图生成的是没有意义的图，每个点代表每种组合，facet_grid (drv ~ cyl) 生成的图则将每个组合中 displ 和 hwy 之间的关系表现了出来。</p><p>(3) 以下代码会绘制出什么图？ . 的作用是什么？</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_point(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="3"></td><td><pre>  facet_grid(drv ~ .)</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727165523271.png" alt="image-20200727165523271"></p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_point(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="3"></td><td><pre>facet_grid(. ~ cyl)</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727165631279.png" alt="image-20200727165631279"></p><p>. 的作用决定了分布方向，如果前面出现、纵向分布，反之为横向分布</p><p>(4) 查看本节的第一个分面图：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_point(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="3"></td><td><pre>facet_wrap(~ class, nrow &#x3D; 2)</pre></td></tr></table></figure><p>与使用图形属性相比，使用分面的优势和劣势分别是什么？如果有一个更大的数据集，<br>你将如何权衡这两种方法的优劣？</p><p>使用分面能更好的体现出每个类别 displ 与 hwy 的关系，但是没办法比较不同类别之间的区别</p><p>使用属性能更好的体现整体的关系，但是个体差异不明显</p><h2 id="16-几何对象"><a class="anchor" href="#16-几何对象">#</a> 1.6 几何对象</h2><p><img data-src="/img/posts/7.22/image-20200727170602843.png" alt="image-20200727170602843"></p><p>两张图有同样的 x 变量和 y 变量，而且描述的是同样的数据。但这两张图并不一样，它们各自使用不同的可视化对象来表示数据。在 ggplot2 语法中，我们称它们使用了不同的几何对象。</p><p>几何对象是图中用来表示数据的几何图形对象。我们经常根据图中使用的几何对象类型来描述相应的图。例如，条形图使用了条形几何对象，折线图使用了直线几何对象，箱线图使用了矩形和直线几何对象。散点图打破了这种趋势，它们使用点几何对象。如上面的两幅图所示，我们可以使用不同的几何对象来表示同样的数据。左侧的图使用了点几何对象，右侧的图使用了平滑曲线几何对象，以一条平滑曲线来拟合数据。要想改变图中的几何对象，需要修改添加在 ggplot () 函数中的几何对象函数。举例来说，要想绘制出上图，你可以使用以下代码：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre># 左图</pre></td></tr><tr><td data-num="2"></td><td><pre>ggplot (data &#x3D; mpg) +</pre></td></tr><tr><td data-num="3"></td><td><pre>geom_point (mapping &#x3D; aes (x &#x3D; displ, y &#x3D; hwy))</pre></td></tr><tr><td data-num="4"></td><td><pre># 右图</pre></td></tr><tr><td data-num="5"></td><td><pre>ggplot (data &#x3D; mpg) +</pre></td></tr><tr><td data-num="6"></td><td><pre>geom_smooth (mapping &#x3D; aes (x &#x3D; displ, y &#x3D; hwy))</pre></td></tr></table></figure><p>ggplot2 中的每个几何对象函数都有一个 mapping 参数。但是，不是每种图形属性都适合每种几何对象。你可以设置点的形状，但不能设置线的 “形状”，而可以设置线的线型。geom_smooth () 函数可以按照不同的线型绘制出不同的曲线，每条曲线对应映射到线型的变量的一个唯一值：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_smooth(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy, linetype &#x3D; drv))</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727170835224.png" alt="image-20200727170835224"></p><p>根据表示汽车驱动系统的 drv 变量的值，这里的 geom_smooth () 函数分别用 3 条曲线来表示汽车。一条线表示 drv 值为 4 的所有汽车，一条线表示 drv 值为 f 的所有汽车，另一条线表示 drv 值为 r 的所有汽车。其中 4 表示四轮驱动，f 表示前轮驱动，r 表示后轮驱动。如果你觉得这有些难以理解，我们可以将这些曲线覆盖在原始数据上，并按照 drv 值对所有的点和线进行着色，这样你就能看得更清楚一些了。</p><p>要想在同一张图中显示多个几何对象，可以向 ggplot () 函数中添加多个几何对象函数：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_point(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="3"></td><td><pre>  geom_smooth(mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy))</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727200840974.png" alt="image-20200727200840974"></p><p>但是，这样代码就产生了一些重复。假如你想将 y 轴上的变量从 hwy 改成 cty，那么就要在两个地方修改这个变量，但你或许会漏掉一处。避免这种重复的方法是将一组映射传递给 ggplot () 函数。ggplot2 会将这些映射作为全局映射应用到图中的每个几何对象中。</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg, mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_point() +</pre></td></tr><tr><td data-num="3"></td><td><pre>geom_smooth()</pre></td></tr></table></figure><p>如果将映射放在几何对象函数中，那么 ggplot2 会将其看作这个图层的局部映射，它将使用这些映射扩展或覆盖全局映射，但仅对该图层有效。这样一来，我们就可以在不同的图层中显示不同的图形属性：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg, mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_point(mapping &#x3D; aes(color &#x3D; class)) +</pre></td></tr><tr><td data-num="3"></td><td><pre>geom_smooth()</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727202738338.png" alt="image-20200727202738338"></p><p>同理，你也可以为不同的图层指定不同的数据。下图中的平滑曲线表示的只是 mpg 数据集的一个子集，即微型车。geom_smooth () 函数中的局部数据参数覆盖了 ggplot () 函数中的全局数据参数，当然仅对这个图层有效：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg, mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_point(mapping &#x3D; aes(color &#x3D; class)) +</pre></td></tr><tr><td data-num="3"></td><td><pre>geom_smooth(</pre></td></tr><tr><td data-num="4"></td><td><pre>data &#x3D; filter(mpg, class &#x3D;&#x3D; &quot;subcompact&quot;),</pre></td></tr><tr><td data-num="5"></td><td><pre>se &#x3D; FALSE</pre></td></tr><tr><td data-num="6"></td><td><pre>)</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727202937812.png" alt="image-20200727202937812"></p><h3 id="练习-3"><a class="anchor" href="#练习-3">#</a> 练习</h3><p>(1) 在绘制折线图、箱线图、直方图和分区图时，应该分别使用哪种几何对象？</p><p>折线图使用了直线几何对象，箱线图使用了矩形和直线几何图像、直方图使用了使用了矩形几何对象</p><p>(2) 在脑海中运行以下代码，并预测会有何种输出。接着在 R 中运行代码，并检查你的预测是否正确。</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(</pre></td></tr><tr><td data-num="2"></td><td><pre>  data &#x3D; mpg,</pre></td></tr><tr><td data-num="3"></td><td><pre>  mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy, color &#x3D; drv)</pre></td></tr><tr><td data-num="4"></td><td><pre>) +</pre></td></tr><tr><td data-num="5"></td><td><pre>  geom_point() +</pre></td></tr><tr><td data-num="6"></td><td><pre>  geom_smooth(se &#x3D; FALSE)</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727203901643.png" alt="image-20200727203901643"></p><p>(3) show.legend = FALSE 的作用是什么？删除它会发生什么情况？你觉得我为什么要在本章前面的示例中使用这句代码？</p><p>sohw.legend=FLASE 去掉图例</p><p>(4) geom_smooth () 函数中的 se 参数的作用是什么？</p><p>se 如果设定为 TRUE，则会为曲线设定置信区间，FLASE 则没有置信区间</p><p>(6) 自己编写 R 代码来生成以下各图。</p><p><img data-src="/img/posts/7.22/image-20200727204433561.png" alt="image-20200727204433561"></p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>#######1</pre></td></tr><tr><td data-num="2"></td><td><pre>ggplot(data &#x3D; mpg, mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="3"></td><td><pre>  geom_point() +</pre></td></tr><tr><td data-num="4"></td><td><pre>  geom_smooth(se&#x3D;FALSE)</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>#######2</pre></td></tr><tr><td data-num="7"></td><td><pre>ggplot() +</pre></td></tr><tr><td data-num="8"></td><td><pre>  geom_point(</pre></td></tr><tr><td data-num="9"></td><td><pre>    data &#x3D; mpg,</pre></td></tr><tr><td data-num="10"></td><td><pre>    mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy)</pre></td></tr><tr><td data-num="11"></td><td><pre>  ) +</pre></td></tr><tr><td data-num="12"></td><td><pre>  geom_smooth(</pre></td></tr><tr><td data-num="13"></td><td><pre>    data &#x3D; mpg,</pre></td></tr><tr><td data-num="14"></td><td><pre>    mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy,group&#x3D;drv),se&#x3D;FALSE)</pre></td></tr><tr><td data-num="15"></td><td><pre>#######3</pre></td></tr><tr><td data-num="16"></td><td><pre>ggplot(data &#x3D; mpg, mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy,color&#x3D;drv)) +</pre></td></tr><tr><td data-num="17"></td><td><pre>  geom_point() +</pre></td></tr><tr><td data-num="18"></td><td><pre>  geom_smooth(se &#x3D; FALSE)</pre></td></tr><tr><td data-num="19"></td><td><pre>#######4</pre></td></tr><tr><td data-num="20"></td><td><pre>ggplot() +</pre></td></tr><tr><td data-num="21"></td><td><pre>  geom_point(</pre></td></tr><tr><td data-num="22"></td><td><pre>    data &#x3D; mpg,</pre></td></tr><tr><td data-num="23"></td><td><pre>    mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy,color&#x3D;drv)</pre></td></tr><tr><td data-num="24"></td><td><pre>  ) +</pre></td></tr><tr><td data-num="25"></td><td><pre>  geom_smooth(</pre></td></tr><tr><td data-num="26"></td><td><pre>    data &#x3D; mpg,</pre></td></tr><tr><td data-num="27"></td><td><pre>    mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy),se&#x3D;FALSE)</pre></td></tr><tr><td data-num="28"></td><td><pre>######5</pre></td></tr><tr><td data-num="29"></td><td><pre>ggplot() +</pre></td></tr><tr><td data-num="30"></td><td><pre>  geom_point(</pre></td></tr><tr><td data-num="31"></td><td><pre>    data &#x3D; mpg,</pre></td></tr><tr><td data-num="32"></td><td><pre>    mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy,color&#x3D;drv)</pre></td></tr><tr><td data-num="33"></td><td><pre>  ) +</pre></td></tr><tr><td data-num="34"></td><td><pre>  geom_smooth(</pre></td></tr><tr><td data-num="35"></td><td><pre>    data &#x3D; mpg,</pre></td></tr><tr><td data-num="36"></td><td><pre>    mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy,linetype&#x3D;drv),se&#x3D;FALSE)</pre></td></tr><tr><td data-num="37"></td><td><pre>######6</pre></td></tr><tr><td data-num="38"></td><td><pre>ggplot() +</pre></td></tr><tr><td data-num="39"></td><td><pre>  geom_point(</pre></td></tr><tr><td data-num="40"></td><td><pre>    data &#x3D; mpg,</pre></td></tr><tr><td data-num="41"></td><td><pre>    mapping &#x3D; aes(x &#x3D; displ, y &#x3D; hwy,color&#x3D;drv))</pre></td></tr></table></figure><h2 id="17-统计变换"><a class="anchor" href="#17-统计变换">#</a> 1.7 统计变换</h2><p>接下来我们看一下条形图。条形图虽然简单，但很有意思，因为它可以揭示出图形中的一些微妙信息。我们看一下用 geom_bar () 函数就可以绘制的基本条形图。下面的条形图显示了 diamonds 数据集中按照 cut 变量分组的各种钻石的总数量。diamonds 数据集是 ggplot2 的内置数据集，包含大约 54 000 颗钻石的信息，每颗钻石具有 price、carat、color、clarity 和 cut 变量。条形图显示，高质量切割钻石的数量要比低质量切割钻石的数量多：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; diamonds) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_bar(mapping &#x3D; aes(x &#x3D; cut))</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727210139975.png" alt="image-20200727210139975"></p><p>条形图 x 轴显示的是 cut，这是 diamonds 数据集中的一个变量。y 轴显示的是 count，但 count 不是 diamonds 中的变量！那么 count 来自哪里呢？很多图形绘制的是数据集的原始数据，比如散点图。另外一些图形则可以绘制那些计算出的新数据，比如条形图。<br>・条形图、直方图和频率多边形图可以对数据进行分箱，然后绘制出分箱数量和落在每个分箱的数据点的数量。<br>・平滑曲线会为数据拟合一个模型，然后绘制出模型预测值。<br>・箱线图可以计算出数据分布的多种摘要统计量，并显示一个特殊形式的箱体。<br>绘图时用来计算新数据的算法称为 stat（statistical transformation，统计变换）。下图描述了 geom_bar () 函数的统计变换过程。</p><p><img data-src="/img/posts/7.22/image-20200727210413879.png" alt="image-20200727210413879"></p><p>通常来说，几何对象函数和统计变换函数可以互换使用。例如，你可以使用 stat_count () 替换 geom_bar () 来重新生成前面那张图：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; diamonds) +</pre></td></tr><tr><td data-num="2"></td><td><pre>stat_count(mapping &#x3D; aes(x &#x3D; cut))</pre></td></tr></table></figure><p>你可能想要覆盖从统计变换生成的变量到图形属性的默认映射。例如，你或许想显示一张表示比例（而不是计数）的条形图：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; diamonds) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_bar(</pre></td></tr><tr><td data-num="3"></td><td><pre>mapping &#x3D; aes(x &#x3D; cut, y &#x3D; ..prop.., group &#x3D; 1)</pre></td></tr><tr><td data-num="4"></td><td><pre>)</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727210604103.png" alt="image-20200727210604103"></p><p>你可能想要在代码中强调统计变换。例如，你可以使用 stat_summary () 函数将人们的注意力吸引到你计算出的那些摘要统计量上。stat_summary () 函数为 x 的每个唯一值计算 y 值的摘要统计：</p><p><img data-src="/img/posts/7.22/image-20200727210714673.png" alt="image-20200727210714673"></p><p>ggplot2 提供了 20 多个统计变换以供你使用。每个统计变换都是一个函数，因此你可以按照通用方式获得帮助，例如？stat_bin。如果想要查看全部的统计变换，可以使用 ggplot2 速查表。</p><h3 id="练习-4"><a class="anchor" href="#练习-4">#</a> 练习</h3><p>(1) stat_summary () 函数的默认几何对象是什么？不使用统计变换函数的话，如何使用几何对象函数重新生成以上的图？</p><p>geom_pointrange，</p><p>(2) geom_col () 函数的功能是什么？它和 geom_bar () 函数有何不同？</p><p>直方图，其中柱状图的高度表示数据中的值，geom_col () 的默认统计变换为 identity ()，geom_bar () 默认为 count ()</p><h2 id="18-位置调整"><a class="anchor" href="#18-位置调整">#</a> 1.8 位置调整</h2><p>可以使用 color 或者 fill（这个更有用）图形属性来为条形图上色：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; diamonds) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_bar(mapping &#x3D; aes(x &#x3D; cut, color &#x3D; cut))</pre></td></tr><tr><td data-num="3"></td><td><pre>ggplot(data &#x3D; diamonds) +</pre></td></tr><tr><td data-num="4"></td><td><pre>geom_bar(mapping &#x3D; aes(x &#x3D; cut, fill &#x3D; cut))</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727211647841.png" alt="image-20200727211647841"></p><p>如果将 fill 图形属性映射到另一个变量（如 clarity），那么条形会自动分块堆叠起来。每个彩色矩形表示 cut 和 clarity 的一种组合。</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; diamonds) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_bar(mapping &#x3D; aes(x &#x3D; cut, fill &#x3D; clarity))</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727211722262.png" alt="image-20200727211722262"></p><p>这种堆叠是由 position 参数设定的位置调整功能自动完成的。如果不想生成堆叠式条形图，你还可以使用以下 3 种选项之一：&quot;identity&quot;、&quot;fill&quot; 和 &quot;dodge&quot;。</p><p>・position = &quot;identity&quot; 将每个对象直接显示在图中。这种方式不太适合条形图，因为条形会彼此重叠。为了让重叠部分能够显示出来，我们可以设置 alpha 参数为一个较小的数，从而使得条形略微透明；或者设定 fill = NA，让条形完全透明：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(</pre></td></tr><tr><td data-num="2"></td><td><pre>  data &#x3D; diamonds,</pre></td></tr><tr><td data-num="3"></td><td><pre>  mapping &#x3D; aes(x &#x3D; cut, fill &#x3D; clarity)</pre></td></tr><tr><td data-num="4"></td><td><pre>) +</pre></td></tr><tr><td data-num="5"></td><td><pre>  geom_bar(alpha &#x3D; 1&#x2F;5, position &#x3D; &quot;identity&quot;)</pre></td></tr><tr><td data-num="6"></td><td><pre>ggplot(</pre></td></tr><tr><td data-num="7"></td><td><pre>  data &#x3D; diamonds,</pre></td></tr><tr><td data-num="8"></td><td><pre>  mapping &#x3D; aes(x &#x3D; cut, color &#x3D; clarity)</pre></td></tr><tr><td data-num="9"></td><td><pre>) +</pre></td></tr><tr><td data-num="10"></td><td><pre>  geom_bar(fill &#x3D; NA, position &#x3D; &quot;identity&quot;)</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727211840520.png" alt="image-20200727211840520"></p><p><img data-src="/img/posts/7.22/image-20200727211928419.png" alt="image-20200727211928419"></p><p>・position = &quot;fill&quot; 的效果与堆叠相似，但每组堆叠条形具有同样的高度，因此这种条形图可以非常轻松地比较各组间的比例：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; diamonds) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_bar(</pre></td></tr><tr><td data-num="3"></td><td><pre>    mapping &#x3D; aes(x &#x3D; cut, fill &#x3D; clarity),</pre></td></tr><tr><td data-num="4"></td><td><pre>    position &#x3D; &quot;fill&quot;</pre></td></tr><tr><td data-num="5"></td><td><pre>  )</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727212050674.png" alt="image-20200727212050674"></p><p>・position = &quot;dodge&quot; 将每组中的条形依次并列放置，这样可以非常轻松地比较每个条形表示的具体数值：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; diamonds) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_bar(</pre></td></tr><tr><td data-num="3"></td><td><pre>    mapping &#x3D; aes(x &#x3D; cut, fill &#x3D; clarity),</pre></td></tr><tr><td data-num="4"></td><td><pre>    position &#x3D; &quot;dodge&quot;</pre></td></tr><tr><td data-num="5"></td><td><pre>  )</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727212148394.png" alt="image-20200727212148394"></p><p>回忆一下我们的第一张散点图。你是否发现，虽然数据集中有 234 个观测值，但散点图中只显示了 126 个点？</p><p><img data-src="/img/posts/7.22/image-20200727212352822.png" alt="image-20200727212352822"></p><p>因为 hwy 和 displ 的值都进行了舍入取整，所以这些点显示在一个网格上时，很多点彼此重叠了。这个问题称为过绘制。点的这种排列方式很难看出数据的聚集模式。数据点是均匀地分布在图中，还是存在 hwy 和 displ 的特殊组合，其中包括了 109 个点？</p><p>通过将位置调整方式设为 “抖动”，可以避免这种网格化排列。position = &quot;jitter&quot; 为每个数据点添加一个很小的随机扰动，这样就可以将重叠的点分散开来，因为不可能有两个点会收到同样的随机扰动：</p><p>添加随机性来改善图形似乎是一种奇怪的方式，然而尽管这种方式会损失图形的精确性，但可以大大提高图形的启发性。因为这种操作的用处非常大，所以 ggplot2 提供了 geom_point (position = &quot;jitter&quot;) 的一种快速实现方式：geom_jitter ()。</p><p><img data-src="/img/posts/7.22/image-20200727212502344.png" alt="image-20200727212502344"></p><h2 id="19坐标系"><a class="anchor" href="#19坐标系">#</a> 1.9 坐标系</h2><p>坐标系可能是 ggplot2 中最复杂的部分。默认的坐标系是笛卡儿直角坐标系，可以通过其独立作用的 x 坐标和 y 坐标找到每个数据点。偶尔也会用到一些其他类型的坐标系。</p><p>・coord_flip () 函数可以交换 x 轴和 y 轴。当想要绘制水平箱线图时，这非常有用。它也非常适合使用长标签，但要想在 x 轴上不重叠地安排好它们是非常困难的：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; mpg, mapping &#x3D; aes(x &#x3D; class, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="2"></td><td><pre>geom_boxplot()</pre></td></tr><tr><td data-num="3"></td><td><pre>ggplot(data &#x3D; mpg, mapping &#x3D; aes(x &#x3D; class, y &#x3D; hwy)) +</pre></td></tr><tr><td data-num="4"></td><td><pre>geom_boxplot() +</pre></td></tr><tr><td data-num="5"></td><td><pre>coord_flip()</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727213205137.png" alt="image-20200727213205137"></p><p>・coord_polar () 函数使用极坐标系。极坐标系可以揭示出条形图和鸡冠花图间的一种有趣联系：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>bar &lt;- ggplot(data &#x3D; diamonds) +</pre></td></tr><tr><td data-num="2"></td><td><pre>  geom_bar(</pre></td></tr><tr><td data-num="3"></td><td><pre>    mapping &#x3D; aes(x &#x3D; cut, fill &#x3D; cut),</pre></td></tr><tr><td data-num="4"></td><td><pre>    show.legend &#x3D; FALSE,</pre></td></tr><tr><td data-num="5"></td><td><pre>    width &#x3D; 1</pre></td></tr><tr><td data-num="6"></td><td><pre>  ) +</pre></td></tr><tr><td data-num="7"></td><td><pre>  theme(aspect.ratio &#x3D; 1) +</pre></td></tr><tr><td data-num="8"></td><td><pre>  labs(x &#x3D; NULL, y &#x3D; NULL)</pre></td></tr><tr><td data-num="9"></td><td><pre>p1&lt;-bar + coord_flip()</pre></td></tr><tr><td data-num="10"></td><td><pre>p2&lt;-bar + coord_polar()</pre></td></tr><tr><td data-num="11"></td><td><pre>ggarrange(p1, p2)</pre></td></tr></table></figure><p><img data-src="/img/posts/7.22/image-20200727213451539.png" alt="image-20200727213451539"></p><h2 id="110-图形分层语法"><a class="anchor" href="#110-图形分层语法">#</a> 1.10　图形分层语法</h2><p>在前面几节中，你学到的绝不仅仅是如何绘制散点图、条形图和箱线图，而是使用 ggplot2 绘制任何类型图形的基础知识。为了说明这一点，我们向前面的代码模板中添加位置调整、统计变换、坐标系和分面：</p><figure class="highlight raw"><figcaption data-lang></figcaption><table><tr><td data-num="1"></td><td><pre>ggplot(data &#x3D; &lt;DATA&gt;) +</pre></td></tr><tr><td data-num="2"></td><td><pre>&lt;GEOM_FUNCTION&gt;(</pre></td></tr><tr><td data-num="3"></td><td><pre>mapping &#x3D; aes(&lt;MAPPINGS&gt;),</pre></td></tr><tr><td data-num="4"></td><td><pre>stat &#x3D; &lt;STAT&gt;,</pre></td></tr><tr><td data-num="5"></td><td><pre>position &#x3D; &lt;POSITION&gt;</pre></td></tr><tr><td data-num="6"></td><td><pre>) +</pre></td></tr><tr><td data-num="7"></td><td><pre>&lt;COORDINATE_FUNCTION&gt; +</pre></td></tr><tr><td data-num="8"></td><td><pre>&lt;FACET_FUNCTION&gt;</pre></td></tr></table></figure><p>为了说明图形语法的工作方式，我们看一下如何从头开始构建一个基本图形：首先需要有一个数据集，然后（通过统计变换）将其转换为想要显示的信息。</p><p><img data-src="/img/posts/7.22/image-20200727213807112.png" alt="image-20200727213807112"></p><p>接下来，你可以选择一个几何对象来表示转换后的数据中的每个观测值，然后选择几何对象的图形属性来表示数据中的变量，这会将每个变量的值映射为图形属性的水平。</p><p><img data-src="/img/posts/7.22/image-20200727213840722.png" alt="image-20200727213840722"></p><p>下一步是选择放置几何对象的坐标系。你可以使用对象位置（对象本身的一个图形属性）来显示 x 变量和 y 变量的值。这样就生成了一张完整的图。但你还可以进一步调整几何对象在坐标系中的位置（位置调整），或者将图划分为多个子图（分面）。你还可以通过添加一个或多个附加图层对图进行扩展，其中每个附加图层都使用一个数据集、一个几何对象、一个映射集合、一个统计变换和一个位置调整。</p><p><img data-src="/img/posts/7.22/image-20200727213914023.png" alt="image-20200727213914023"></p><hr><p>转载请注明<a href="www.zhouxiaozao.cn">周小钊的博客</a> &gt;&gt;<a href="www.zhouxiaozhao.cn/2020/07/22/R4ds1/">R4ds1</a></p><div class="tags"><a href="/tags/R-study/" rel="tag"><i class="ic i-tag"></i> R_study</a> <a href="/tags/R-For-Data-science/" rel="tag"><i class="ic i-tag"></i> R_For_Data_science</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-03-08 14:44:23" itemprop="dateModified" datetime="2023-03-08T14:44:23+08:00">2023-03-08</time> </span><span id="2020/07/22/2020-07-22-R4ds1/" class="item leancloud_visitors" data-flag-title="R 数据科学笔记：1" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="amane 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="amane 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>amane <i class="ic i-at"><em>@</em></i>小钊の笔记</li><li class="link"><strong>本文链接：</strong> <a href="https://www.zhouxiaozhao.cn/2020/07/22/2020-07-22-R4ds1/" title="R 数据科学笔记：1">https://www.zhouxiaozhao.cn/2020/07/22/2020-07-22-R4ds1/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2020/07/20/2020-07-20-fungi/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;img1.imgtp.com&#x2F;2023&#x2F;02&#x2F;01&#x2F;XEdGqgmv.jpg" title="文献导读：真菌进化"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 生信学习</span><h3>文献导读：真菌进化</h3></a></div><div class="item right"><a href="/2020/07/25/2020-07-25-R4ds2/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;img1.imgtp.com&#x2F;2023&#x2F;02&#x2F;01&#x2F;XEdGqgmv.jpg" title="R数据科学笔记:2"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> R</span><h3>R数据科学笔记:2</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%9C%E8%80%85%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">作者简介：</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0%E4%BD%BF%E7%94%A8ggplot2%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-number">2.</span> <span class="toc-text">第一章：使用 ggplot2 进行数据可视化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E7%AE%80%E4%BB%8B"><span class="toc-number">2.1.</span> <span class="toc-text">1.1 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E7%AC%AC%E4%B8%80%E6%AD%A5"><span class="toc-number">2.2.</span> <span class="toc-text">1.2 第一步</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#121-mpg%E6%95%B0%E6%8D%AE%E6%A1%86"><span class="toc-number">2.2.1.</span> <span class="toc-text">1.2.1 mpg 数据框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#122-%E5%88%9B%E5%BB%BAggplot%E5%9B%BE%E5%BD%A2"><span class="toc-number">2.2.2.</span> <span class="toc-text">1.2.2　创建 ggplot 图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#123-%E7%BB%98%E5%9B%BE%E6%A8%A1%E6%9D%BF"><span class="toc-number">2.2.3.</span> <span class="toc-text">1.2.3　绘图模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#124-%E7%BB%83%E4%B9%A0"><span class="toc-number">2.2.4.</span> <span class="toc-text">1.2.4　练习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E5%9B%BE%E5%BD%A2%E5%B1%9E%E6%80%A7%E6%98%A0%E5%B0%84"><span class="toc-number">2.3.</span> <span class="toc-text">1.3　图形属性映射</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0"><span class="toc-number">2.3.1.</span> <span class="toc-text">练习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="toc-number">2.4.</span> <span class="toc-text">1.4 常见问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-%E5%88%86%E9%9D%A2"><span class="toc-number">2.5.</span> <span class="toc-text">1.5 分面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0-2"><span class="toc-number">2.5.1.</span> <span class="toc-text">练习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-%E5%87%A0%E4%BD%95%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.6.</span> <span class="toc-text">1.6 几何对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0-3"><span class="toc-number">2.6.1.</span> <span class="toc-text">练习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-%E7%BB%9F%E8%AE%A1%E5%8F%98%E6%8D%A2"><span class="toc-number">2.7.</span> <span class="toc-text">1.7 统计变换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0-4"><span class="toc-number">2.7.1.</span> <span class="toc-text">练习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-%E4%BD%8D%E7%BD%AE%E8%B0%83%E6%95%B4"><span class="toc-number">2.8.</span> <span class="toc-text">1.8 位置调整</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19%E5%9D%90%E6%A0%87%E7%B3%BB"><span class="toc-number">2.9.</span> <span class="toc-text">1.9 坐标系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#110-%E5%9B%BE%E5%BD%A2%E5%88%86%E5%B1%82%E8%AF%AD%E6%B3%95"><span class="toc-number">2.10.</span> <span class="toc-text">1.10　图形分层语法</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/2020/07/22/2020-07-22-R4ds1/" rel="bookmark" title="R数据科学笔记：1">R数据科学笔记：1</a></li><li><a href="/2020/07/25/2020-07-25-R4ds2/" rel="bookmark" title="R数据科学笔记:2">R数据科学笔记:2</a></li><li><a href="/2020/08/10/2020-08-13-R4ds3/" rel="bookmark" title="R数据科学笔记:3">R数据科学笔记:3</a></li><li><a href="/2020/08/16/2020-08-16-R4ds4/" rel="bookmark" title="R数据科学笔记:4">R数据科学笔记:4</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="amane" data-src="/images/avatar.jpg"><p class="name" itemprop="name">amane</p><div class="description" itemprop="description">生物学在读博士</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">85</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">8</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">22</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0Jpb2luZm9ybWF0aWNzLXJvb2tpZQ==" title="https:&#x2F;&#x2F;github.com&#x2F;Bioinformatics-rookie"><i class="ic i-github"></i></span> <span class="exturl item bilibili" data-url="aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vMTU3Nzg1NTM/c3BtX2lkX2Zyb209MzMzLjEwMDcuMC4w" title="https:&#x2F;&#x2F;space.bilibili.com&#x2F;15778553?spm_id_from&#x3D;333.1007.0.0"><i class="ic i-bilibili"></i></span> <a href="https://www.zhouxiaozhao.cn/about/" title="https:&#x2F;&#x2F;www.zhouxiaozhao.cn&#x2F;about&#x2F;" class="item about"><i class="ic i-address-card"></i></a> <span class="exturl item email" data-url="bWFpbHRvOnpob3VzaGl6aGFvQG1haWwua2liLmFjLmNu" title="mailto:zhoushizhao@mail.kib.ac.cn"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item dropdown"><a href="/webstack/" rel="section"><i class="ic i-magic"></i>AI学习</a><ul class="submenu"><li class="item"><a href="/AIpainting/" rel="section"><i class="ic i-pen"></i>AI绘画</a></li><li class="item"><a href="/AIfile/" rel="section"><i class="ic i-file"></i>AI图包</a></li><li class="item"><a href="/AIbookmark/" rel="section"><i class="ic i-comments"></i>AI书签</a></li></ul></li><li class="item"><a href="/links/" rel="section"><i class="ic i-heart"></i>友達</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2020/07/20/2020-07-20-fungi/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2020/07/25/2020-07-25-R4ds2/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Bioinformation/" title="分类于 生信学习">生信学习</a></div><span><a href="/2021/01/05/2021-01-05-RNAseq(18)/" title="RNAseq教程(4.3)">RNAseq教程(4.3)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bioinformation/" title="分类于 生信学习">生信学习</a></div><span><a href="/2020/11/21/2020-11-21-annotion(2)/" title="基因结构注释（2）：同源注释">基因结构注释（2）：同源注释</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/paper/" title="分类于 文献导读">文献导读</a></div><span><a href="/2020/07/30/2020-07-30-HGT/" title="文献导读:真菌和陆栖藻类水平基因转移">文献导读:真菌和陆栖藻类水平基因转移</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bioinformation/" title="分类于 生信学习">生信学习</a> <i class="ic i-angle-right"></i> <a href="/categories/Bioinformation/SingleCell/" title="分类于 单细胞">单细胞</a></div><span><a href="/2020/09/29/2020-09-29-ScRNAseq(1)/" title="单细胞实战(1)：原始测序数据下载">单细胞实战(1)：原始测序数据下载</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bioinformation/" title="分类于 生信学习">生信学习</a></div><span><a href="/2020/08/18/2020-08-18-sys/" title="根据转录组数据鉴定共生物种">根据转录组数据鉴定共生物种</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bioinformation/" title="分类于 生信学习">生信学习</a> <i class="ic i-angle-right"></i> <a href="/categories/Bioinformation/SingleCell/" title="分类于 单细胞">单细胞</a></div><span><a href="/2020/10/13/2020-10-13-ScRNAseq(6)/" title="单细胞实战(5)：复现文章中的聚类图（2）">单细胞实战(5)：复现文章中的聚类图（2）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Python/" title="分类于 Python">Python</a></div><span><a href="/2020/09/26/2020-09-26-python5/" title="马士兵教育Python入门基础:3.运算（1）">马士兵教育Python入门基础:3.运算（1）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bioinformation/" title="分类于 生信学习">生信学习</a> <i class="ic i-angle-right"></i> <a href="/categories/Bioinformation/SingleCell/" title="分类于 单细胞">单细胞</a></div><span><a href="/2020/11/07/2020-11-07-ScRNAseq(13)/" title="生信技能树单细胞数据挖掘笔记(7)">生信技能树单细胞数据挖掘笔记(7)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bioinformation/" title="分类于 生信学习">生信学习</a></div><span><a href="/2020/11/17/2020-11-17-RNAseq(1)/" title="RNAseq教程(1.1)">RNAseq教程(1.1)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Bioinformation/" title="分类于 生信学习">生信学习</a></div><span><a href="/2020/12/19/2020-12-19-RNAseq(11)/" title="RNAseq教程(2.5)">RNAseq教程(2.5)</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">amane @ Zhou Xiaozhao</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">385k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">5:50</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2020/07/22/2020-07-22-R4ds1/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->